!function(e,t){if("function"==typeof define&&define.amd)define(["exports","backbone.radio","marionette","webcomponents.js"],t);else if("undefined"!=typeof exports)t(exports,require("backbone.radio"),require("marionette"),require("webcomponents.js"));else{var n={exports:{}};t(n.exports,e.backbone,e.marionette,e.webcomponents),e.index=n.exports}}(this,function(e,t,n,o){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e){return function(t,n,o){if(t.events||(t.events={}),"function"==typeof t.events)throw new Error("The on decorator is only compatible with an events object");if(!e)throw new Error("The on decorator requires an eventName argument");return t.addEvent(e,n,t),o}}Object.defineProperty(e,"__esModule",{value:!0}),e.View=e.Component=void 0,e.on=h;var u,c=r(t),d=r(n),f=(i(o),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}()),p=(e.Component=function(){function e(t,n,o){l(this,e),this.__disableShadowDOM=!1,this.radioChannel=c.default.channel("components:"+n),this.elementChannel=c.default.channel("elements:"+t),o.disableShadowDOM&&(this.__disableShadowDOM=!0),this.initialize()}return f(e,[{key:"renderComponent",value:function(e,t,n,o){var i=this;void 0!==o&&(this.state=o),void 0===this.events&&(this.events={}),u={elementName:e,element:t,stylesheet:n,disableShadowDOM:i.__disableShadowDOM},this.radioChannel.on("attached",function(e){if(0!==Object.keys(i.events).length&&i.events.constructor===Object){var t=function(t){var n=t.split(" ");e.addEventListener(n[0],function(o){if(n.length<=2&&void 0!==n[1]){var r=e;i.__disableShadowDOM||(r=e.shadowRoot),r.querySelector(n[1]).length<=1?o.path&&o.path[0]===r.querySelector(n[1])&&i.radioChannel.trigger("eventListenerTriggered",i.events[t],o):r.querySelectorAll(n[1]).forEach(function(e){o.path&&o.path[0]===e&&i.radioChannel.trigger("eventListenerTriggered",i.events[t],o)})}else i.radioChannel.trigger("eventListenerTriggered",i.events[t],o)})};for(var n in i.events)t(n)}})}},{key:"initialize",value:function(){var e=this;this.radioChannel.on("eventListenerTriggered",function(t,n){return e[t](n)})}},{key:"addEvent",value:function(e,t){this.events[e]=t}},{key:"removeEvent",value:function(e,t){void 0!==e&&"function"==typeof t&&(this.element.removeEventListener(e,t),delete this.events[e])}},{key:"element",get:function(){return p},set:function(e){p=e}}]),e}(),function(e){function t(){return l(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),f(t,[{key:"createdCallback",value:function(){this._element=u.element,this._stylesheet=u.stylesheet,this._elementName=u.elementName,this._hasShadowRoot=!u.disableShadowDOM;var e=this;this._hasShadowRoot&&(e=this.createShadowRoot()),e.innerHTML="<style>"+this.stylesheet.toString()+"</style>"+this.element}},{key:"attachedCallback",value:function(){c.default.channel("components:"+this._elementName).trigger("attached",this)}},{key:"attributeChangedCallback",value:function(e,t,n){c.default.channel("components:"+this._elementName).trigger("attributeChanged",{attributeName:e,previousAttribute:t,newAttribute:n})}},{key:"detachedCallback",value:function(){c.default.channel("components:"+this._elementName).trigger("detached")}},{key:"updateElement",value:function(e,t){var n=this._hasShadowRoot,o=this;n&&(o=this.shadowRoot),void 0!==e&&(this.element=e),void 0!==e&&(this.stylesheet=t),this.hasUpdated&&(o.innerHTML="<style>"+this.stylesheet.toString()+"</style>"+this.element)}},{key:"element",set:function(e){this.hasUpdated=!0,this._previousElement=this._element,this._element=e},get:function(){return this._element}},{key:"elementName",get:function(){return this._elementName}},{key:"previousElement",get:function(){return this._previousElement}},{key:"stylesheet",set:function(e){this.hasUpdated=!0,this._previousStylesheet=this._stylesheet,this._stylesheet=e},get:function(){return this._stylesheet}},{key:"hasUpdated",set:function(e){if("boolean"!=typeof e)throw new TypeError("Updated can only be a boolean type");this._updated=e,e&&c.default.channel("components:"+this._elementName).trigger("updated")},get:function(){return this._updated}},{key:"radio",get:function(){return c.default.channel("components:"+this._elementName)}}]),t}(HTMLElement));e.View=function(e){function t(){var e,n,o,i;l(this,t);for(var r=arguments.length,a=Array(r),h=0;h<r;h++)a[h]=arguments[h];return n=o=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),o._components={},o._componentChannels={},o._count={},i=n,s(o,i)}return a(t,e),f(t,[{key:"getComponent",value:function(e){return{component:this._components[e],radioChannel:this._componentChannels[e]}}},{key:"registerComponent",value:function(e,t,n,o,i){var r=void 0;void 0!==this._components[t]?(void 0===this._count[t]&&(this._count[t]=0),r=t+"-"+this._count[t],this._count[t]++):r=t;var s=e.register(t,n,i,r),a=e.getComponent(r);return this._components[r]={element:a.component,module:a.componentModule},this._componentChannels[r]=a.radioChannel||{},void 0!==o.jquery?o.append(s):o.appendChild(s),r}},{key:"deleteComponent",value:function(e){delete this._components[e],delete this._componentChannels[e]}},{key:"clearComponents",value:function(){for(var e in this._components)this._components.hasOwnProperty(e)&&(delete this._components[e],delete this._componentChannels[e]);for(var t in this._count)this._count.hasOwnProperty(t)&&delete this._count[t]}}]),t}(d.default.View)});