!function(e,t){if("function"==typeof define&&define.amd)define(["exports","backbone.radio","marionette"],t);else if("undefined"!=typeof exports)t(exports,require("backbone.radio"),require("marionette"));else{var n={exports:{}};t(n.exports,e.backbone,e.marionette),e.index=n.exports}}(this,function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){return function(t,n,o){if(t.events||(t.events={}),"function"==typeof t.events)throw new Error("The on decorator is only compatible with an events object");if(!e)throw new Error("The on decorator requires an eventName argument");return t.addEvent(e,n,t),o}}Object.defineProperty(e,"__esModule",{value:!0}),e.View=e.Component=void 0,e.on=a;var l,u=o(t),h=o(n),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),d=(e.Component=function(){function e(t,n){s(this,e),this.radioChannel=u.default.channel("components:"+n),this.elementChannel=u.default.channel("elements:"+t),this.initialize()}return c(e,[{key:"renderComponent",value:function(e,t,n,o){var i=this;void 0!==o&&(this.state=o),void 0===this.events&&(this.events={}),l={elementName:e,element:t,stylesheet:n},this.radioChannel.on("attached",function(e){if(0!==Object.keys(i.events).length&&i.events.constructor===Object){var t=function(t){var n=t.split(" ");e.addEventListener(n[0],function(o){n.length<=2&&void 0!==n[1]?e.shadowRoot.querySelector(n[1]).length<=1?o.path&&o.path[0]===e.shadowRoot.querySelector(n[1])&&i.radioChannel.trigger("eventListenerTriggered",i.events[t],o):e.shadowRoot.querySelectorAll(n[1]).forEach(function(e){o.path&&o.path[0]===e&&i.radioChannel.trigger("eventListenerTriggered",i.events[t],o)}):i.radioChannel.trigger("eventListenerTriggered",i.events[t],o)})};for(var n in i.events)t(n)}})}},{key:"initialize",value:function(){var e=this;this.radioChannel.on("eventListenerTriggered",function(t,n){return e[t](n)})}},{key:"addEvent",value:function(e,t){this.events[e]=t}},{key:"removeEvent",value:function(e,t){void 0!==e&&"function"==typeof t&&(this.element.removeEventListener(e,t),delete this.events[e])}},{key:"element",get:function(){return d},set:function(e){d=e}}]),e}(),function(e){function t(){return s(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),c(t,[{key:"createdCallback",value:function(){this._element=l.element,this._stylesheet=l.stylesheet,this._elementName=l.elementName,this.createShadowRoot().innerHTML="<style>"+this.stylesheet.toString()+"</style>"+this.element}},{key:"attachedCallback",value:function(){u.default.channel("components:"+this._elementName).trigger("attached",this)}},{key:"attributeChangedCallback",value:function(e,t,n){u.default.channel("components:"+this._elementName).trigger("attributeChanged",{attributeName:e,previousAttribute:t,newAttribute:n})}},{key:"detachedCallback",value:function(){u.default.channel("components:"+this._elementName).trigger("detached")}},{key:"updateElement",value:function(e,t){void 0!==e&&(this.element=e),void 0!==e&&(this.stylesheet=t),this.hasUpdated&&(this.shadowRoot.innerHTML="<style>"+this.stylesheet.toString()+"</style>"+this.element)}},{key:"element",set:function(e){this.hasUpdated=!0,this._previousElement=this._element,this._element=e},get:function(){return this._element}},{key:"elementName",get:function(){return this._elementName}},{key:"previousElement",get:function(){return this._previousElement}},{key:"stylesheet",set:function(e){this.hasUpdated=!0,this._previousStylesheet=this._stylesheet,this._stylesheet=e},get:function(){return this._stylesheet}},{key:"hasUpdated",set:function(e){if("boolean"!=typeof e)throw new TypeError("Updated can only be a boolean type");this._updated=e,e&&u.default.channel("components:"+this._elementName).trigger("updated")},get:function(){return this._updated}},{key:"radio",get:function(){return u.default.channel("components:"+this._elementName)}}]),t}(HTMLElement));e.View=function(e){function t(){var e,n,o,r;s(this,t);for(var a=arguments.length,l=Array(a),u=0;u<a;u++)l[u]=arguments[u];return n=o=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),o._components={},o._componentChannels={},o._count={},r=n,i(o,r)}return r(t,e),c(t,[{key:"getComponent",value:function(e){return{component:this._components[e],radioChannel:this._componentChannels[e]}}},{key:"registerComponent",value:function(e,t,n,o,i){var r=void 0;void 0!==this._components[t]?(void 0===this._count[t]&&(this._count[t]=0),r=t+"-"+this._count[t],this._count[t]++):r=t;var s=e.register(t,n,i,r),a=e.getComponent(r);return this._components[r]={element:a.component,module:a.componentModule},this._componentChannels[r]=a.radioChannel||{},void 0!==o.jquery?o.append(s):o.appendChild(s),r}},{key:"deleteComponent",value:function(e){delete this._components[e],delete this._componentChannels[e]}},{key:"clearComponents",value:function(){for(var e in this._components)this._components.hasOwnProperty(e)&&(delete this._components[e],delete this._componentChannels[e]);for(var t in this._count)this._count.hasOwnProperty(t)&&delete this._count[t]}}]),t}(h.default.View)});